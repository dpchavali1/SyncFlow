{
  "rules": {
    "users": {
      ".read": "auth != null && auth.token.admin === true",
      ".write": "auth != null && auth.token.admin === true",
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid || auth.token.admin === true || auth.uid == 'durgaprasad.chavali@gmail.com' || auth.uid == 'admin')",
        ".write": "auth != null && auth.uid == $uid",
        "profile": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && auth.uid == $uid",
          "phone": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 20)"
          },
          "phoneHash": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 64)"
          },
          "phoneVerifiedAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "platform": {
            ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'ios'))"
          },
          "email": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
          },
          "displayName": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
          }
        },
        "subscription": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid || auth.token.admin === true)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.admin === true)",
          "plan": {
            ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'free' || newData.val() == 'monthly' || newData.val() == 'yearly' || newData.val() == 'lifetime'))"
          },
          "deviceLimit": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "createdAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "planExpiresAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        },
        "devices": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$deviceId": {
            ".write": "auth != null && (auth.uid == $uid || (auth.token.pairedUid == $uid && auth.token.deviceId == $deviceId))",
            ".validate": "newData.hasChildren(['name'])",
            "name": {
              ".validate": "newData.isString() && newData.val().length <= 50"
            },
            "type": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'web' || newData.val() == 'macos' || newData.val() == 'ios'))"
            },
            "platform": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'web' || newData.val() == 'macos' || newData.val() == 'ios' || newData.val() == 'macOS'))"
            },
            "pairedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "isPaired": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "lastSeen": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          }
        },
        "usage": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "plan": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 20)"
          },
          "planUpdatedAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "planExpiresAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "trialStartedAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "storageBytes": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "lastUpdatedAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "monthly": {
            "$period": {
              "uploadBytes": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "mmsBytes": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "fileBytes": {
                ".validate": "!newData.exists() || newData.isNumber()"
              }
            }
          }
        },
        "messages": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$messageId": {
            ".validate": "newData.hasChildren(['address', 'body', 'date', 'type'])",
            "address": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
            },
            "body": {
              ".validate": "newData.isString() && newData.val().length <= 1600"
            },
            "date": {
              ".validate": "newData.isNumber()"
            },
            "type": {
              ".validate": "newData.isNumber() && (newData.val() == 1 || newData.val() == 2)"
            },
            "contactName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
            }
          },
          ".indexOn": ["date", "timestamp"]
        },
        "outgoing_messages": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$messageId": {
            ".validate": "newData.hasChildren(['address', 'body'])",
            "address": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
            },
            "body": {
              ".validate": "newData.isString() && newData.val().length <= 1600"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "status": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'pending' || newData.val() == 'sent' || newData.val() == 'failed'))"
            }
          },
          ".indexOn": ["timestamp", "status"]
        },
        "read_receipts": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$messageId": {
            ".validate": "newData.hasChildren(['readAt', 'readBy'])",
            "messageId": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "readAt": {
              ".validate": "newData.isNumber()"
            },
            "readBy": {
              ".validate": "newData.isString()"
            },
            "readDeviceName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "conversationAddress": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        },
        "message_reactions": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)"
        },
        "spam_messages": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$spamId": {
            ".validate": "newData.hasChildren(['address', 'body', 'date'])",
            "address": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
            },
            "body": {
              ".validate": "newData.isString() && newData.val().length <= 1600"
            },
            "date": {
              ".validate": "newData.isNumber()"
            },
            "contactName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
            },
            "spamConfidence": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "spamReasons": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "detectedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "isUserMarked": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "isRead": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            }
          },
          ".indexOn": ["date", "timestamp"]
        },
        "spam_whitelist": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$index": {
            ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
          }
        },
        "spam_blocklist": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$index": {
            ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
          }
        },
        "file_transfers": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$fileId": {
            ".validate": "(!data.exists() && newData.hasChildren(['fileName','fileSize','contentType','downloadUrl','source','status','timestamp'])) || data.exists()",
            "fileName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length > 0 && newData.val().length <= 255)"
            },
            "fileSize": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "contentType": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "downloadUrl": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "source": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'macos' || newData.val() == 'web'))"
            },
            "status": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'pending' || newData.val() == 'uploading' || newData.val() == 'uploaded' || newData.val() == 'downloading' || newData.val() == 'downloaded' || newData.val() == 'failed'))"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "error": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          },
          ".indexOn": ["timestamp", "status"]
        },
        "continuity_state": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$deviceId": {
            ".validate": "newData.hasChildren(['type', 'address', 'timestamp', 'platform', 'deviceName'])",
            "type": {
              ".validate": "newData.isString() && newData.val() == 'conversation'"
            },
            "address": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
            },
            "contactName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
            },
            "threadId": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "draft": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 1000)"
            },
            "deviceName": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
            },
            "deviceId": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "platform": {
              ".validate": "newData.isString() && (newData.val() == 'android' || newData.val() == 'macos' || newData.val() == 'web')"
            },
            "timestamp": {
              ".validate": "newData.isNumber()"
            }
          },
          ".indexOn": ["timestamp"]
        },
        "groups": {
          "$groupId": {
            ".validate": "newData.hasChildren(['name', 'createdAt'])",
            "members": {
              "$memberId": {
                ".validate": "newData.isBoolean()"
              }
            }
          }
        },
        "calls": {
          "$callId": {
            ".validate": "newData.hasChildren(['phoneNumber', 'callType', 'callState'])",
            "id": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "phoneNumber": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "contactName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "callType": {
              ".validate": "newData.isString() && (newData.val() == 'incoming' || newData.val() == 'outgoing')"
            },
            "callState": {
              ".validate": "newData.isString() && (newData.val() == 'ringing' || newData.val() == 'active' || newData.val() == 'ended')"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "date": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "lastUpdated": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          }
        },
        "call_requests": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$requestId": {
            ".validate": "newData.hasChildren(['phoneNumber', 'requestedAt'])",
            "phoneNumber": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
            },
            "contactName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "requestedAt": {
              ".validate": "newData.isNumber()"
            },
            "status": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'pending' || newData.val() == 'calling' || newData.val() == 'completed' || newData.val() == 'failed'))"
            },
            "error": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "completedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "simSubscriptionId": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "simSlotIndex": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          },
          ".indexOn": ["requestedAt", "status"]
        },
        "sims": {
          ".validate": "newData.isString() || newData.hasChildren()",
          "$simIndex": {
            "subscriptionId": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "slotIndex": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "displayName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "carrierName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "phoneNumber": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "iccId": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "isEmbedded": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "isActive": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            }
          }
        },
        "syncflow_calls": {
          "$callId": {
            ".validate": "newData.hasChildren(['callerId', 'calleeId', 'callType', 'status'])",
            "id": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "callerId": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "callerName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
            },
            "callerPlatform": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'macos' || newData.val() == 'ios' || newData.val() == 'web'))"
            },
            "calleeId": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "calleeName": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
            },
            "calleePlatform": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'android' || newData.val() == 'macos' || newData.val() == 'ios' || newData.val() == 'web'))"
            },
            "callType": {
              ".validate": "newData.isString() && (newData.val() == 'audio' || newData.val() == 'video')"
            },
            "status": {
              ".validate": "newData.isString() && (newData.val() == 'ringing' || newData.val() == 'active' || newData.val() == 'ended' || newData.val() == 'rejected' || newData.val() == 'missed' || newData.val() == 'failed')"
            },
            "startedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "answeredAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "endedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "offer": {
              ".validate": "!newData.exists() || newData.hasChildren(['sdp', 'type'])",
              "sdp": {
                ".validate": "newData.isString()"
              },
              "type": {
                ".validate": "newData.isString() && newData.val() == 'offer'"
              }
            },
            "answer": {
              ".validate": "!newData.exists() || newData.hasChildren(['sdp', 'type'])",
              "sdp": {
                ".validate": "newData.isString()"
              },
              "type": {
                ".validate": "newData.isString() && newData.val() == 'answer'"
              }
            },
            "ice_caller": {
              "$candidateId": {
                ".validate": "newData.hasChildren(['candidate', 'sdpMLineIndex'])",
                "candidate": {
                  ".validate": "newData.isString()"
                },
                "sdpMid": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "sdpMLineIndex": {
                  ".validate": "newData.isNumber()"
                }
              }
            },
            "ice_callee": {
              "$candidateId": {
                ".validate": "newData.hasChildren(['candidate', 'sdpMLineIndex'])",
                "candidate": {
                  ".validate": "newData.isString()"
                },
                "sdpMid": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "sdpMLineIndex": {
                  ".validate": "newData.isNumber()"
                }
              }
            }
          },
          ".indexOn": ["status", "startedAt", "callerId", "calleeId"]
        },
        "call_commands": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$commandId": {
            ".validate": "newData.hasChildren(['command', 'callId'])",
            "command": {
              ".validate": "newData.isString() && (newData.val() == 'answer' || newData.val() == 'reject' || newData.val() == 'end' || newData.val() == 'mute' || newData.val() == 'unmute')"
            },
            "callId": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "processed": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "phoneNumber": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          },
          ".indexOn": ["timestamp", "processed"]
        },
        "audio_routing_requests": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$requestId": {
            ".validate": "newData.hasChildren(['callId', 'enable'])",
            "callId": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "enable": {
              ".validate": "newData.isBoolean()"
            },
            "processed": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          },
          ".indexOn": ["timestamp", "processed"]
        },
        "active_calls": {
          "$callId": {
            ".validate": "newData.hasChildren(['phoneNumber', 'state'])",
            "phoneNumber": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "contactName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "state": {
              ".validate": "newData.isString() && (newData.val() == 'ringing' || newData.val() == 'active' || newData.val() == 'holding' || newData.val() == 'disconnecting')"
            },
            "direction": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'incoming' || newData.val() == 'outgoing'))"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "duration": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          },
          ".indexOn": ["timestamp", "state"]
        },
        "call_history": {
          "$callId": {
            ".validate": "newData.hasChildren(['phoneNumber', 'callType'])",
            "id": {
              ".validate": "!newData.exists() || newData.isString() || newData.isNumber()"
            },
            "phoneNumber": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "contactName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "callType": {
              ".validate": "newData.isString() && (newData.val() == 'Incoming' || newData.val() == 'Outgoing' || newData.val() == 'Missed' || newData.val() == 'Rejected' || newData.val() == 'Blocked' || newData.val() == 'Voicemail' || newData.val() == 'incoming' || newData.val() == 'outgoing' || newData.val() == 'missed' || newData.val() == 'rejected' || newData.val() == 'blocked' || newData.val() == 'unknown')"
            },
            "callTypeInt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "callDate": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "date": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "duration": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "formattedDuration": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "formattedDate": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "simId": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "syncedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "isRead": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            }
          },
          ".indexOn": ["callDate", "date", "callType", "phoneNumber"]
        },
        "contacts": {
          "$contactId": {
            ".validate": "newData.hasChildren(['displayName','phoneNumbers','sync'])",
            "displayName": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 200"
            },
            "notes": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 1000)"
            },
            "company": {
              ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 200)"
            },
            "phoneNumbers": {
              "$phoneId": {
                "number": {
                  ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
                },
                "normalizedNumber": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 20)"
                },
                "type": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 20)"
                },
                "label": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 20)"
                },
                "isPrimary": {
                  ".validate": "newData.isBoolean()"
                }
              }
            },
            "emails": {
              "$emailId": {
                "address": {
                  ".validate": "newData.isString() && newData.val().length <= 200"
                },
                "type": {
                  ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 50)"
                },
                "isPrimary": {
                  ".validate": "!newData.exists() || newData.isBoolean()"
                }
              }
            },
            "photo": {
              "thumbnailBase64": {
                ".validate": "newData.isString() && newData.val().length <= 150000"
              },
              "hash": {
                ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 64)"
              },
              "storagePath": {
                ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 255)"
              },
              "updatedAt": {
                ".validate": "!newData.exists() || newData.isNumber()"
              }
            },
            "sources": {
              "android": {
                ".validate": "newData.isBoolean()"
              },
              "web": {
                ".validate": "!newData.exists() || newData.isBoolean()"
              },
              "macos": {
                ".validate": "!newData.exists() || newData.isBoolean()"
              }
            },
            "sync": {
              "lastUpdatedAt": {
                ".validate": "newData.isNumber()"
              },
              "lastSyncedAt": {
                ".validate": "!newData.exists() || newData.isNumber()"
              },
              "lastUpdatedBy": {
                ".validate": "newData.isString() && newData.val().length <= 50"
              },
              "version": {
                ".validate": "newData.isNumber()"
              },
              "pendingAndroidSync": {
                ".validate": "newData.isBoolean()"
              },
              "desktopOnly": {
                ".validate": "newData.isBoolean()"
              }
            },
            "androidContactId": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          },
          ".indexOn": ["displayName"]
        },
        "webrtc_signaling": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$callId": {
            "offer": {
              ".validate": "!newData.exists() || newData.hasChildren(['sdp', 'type'])",
              "sdp": {
                ".validate": "newData.isString()"
              },
              "type": {
                ".validate": "newData.isString()"
              },
              "timestamp": {
                ".validate": "!newData.exists() || newData.isNumber()"
              }
            },
            "answer": {
              "$answerId": {
                ".validate": "newData.hasChildren(['sdp', 'type'])",
                "sdp": {
                  ".validate": "newData.isString()"
                },
                "type": {
                  ".validate": "newData.isString()"
                },
                "timestamp": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                }
              }
            },
            "ice_candidates_android": {
              "$candidateId": {
                "candidate": {
                  ".validate": "newData.isString()"
                },
                "sdpMid": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "sdpMLineIndex": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "timestamp": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                }
              }
            },
            "ice_candidates_desktop": {
              "$candidateId": {
                "candidate": {
                  ".validate": "newData.isString()"
                },
                "sdpMid": {
                  ".validate": "!newData.exists() || newData.isString()"
                },
                "sdpMLineIndex": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                },
                "timestamp": {
                  ".validate": "!newData.exists() || newData.isNumber()"
                }
              }
            },
            "status": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          },
          ".indexOn": ["timestamp", "status"]
        },
        "incoming_syncflow_calls": {
          ".read": "auth != null",
          ".write": "auth != null",
          "$callId": {
            ".read": "auth != null && (auth.uid == $uid || data.child('callerUid').val() == auth.uid)",
            ".write": "auth != null && (auth.uid == $uid || data.child('callerUid').val() == auth.uid)",
            ".validate": "newData.hasChildren(['callerUid', 'callType', 'status'])",
            "answer": {
              ".read": "auth != null",
              ".write": "auth != null && auth.uid == $uid"
            },
            "offer": {
              ".read": "auth != null",
              ".write": "auth != null"
            },
            "ice_caller": {
              ".read": "auth != null",
              ".write": "auth != null"
            },
            "ice_callee": {
              ".read": "auth != null",
              ".write": "auth != null && auth.uid == $uid"
            },
            "status": {
              ".read": "auth != null",
              ".write": "auth != null && (auth.uid == $uid || data.parent().child('callerUid').val() == auth.uid)"
            }
          },
          ".indexOn": ["status", "startedAt", "callerUid"]
        },
        "outgoing_syncflow_calls": {
          ".write": "auth != null",
          "$callId": {
            ".validate": "newData.hasChildren(['callType', 'status'])"
          },
          ".indexOn": ["status", "startedAt", "recipientUid"]
        },
        "clipboard": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "content": {
            ".validate": "newData.isString() && newData.val().length <= 100000"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "source": {
            ".validate": "!newData.exists() || newData.isString()"
          }
        },
        "media_command": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "command": {
            ".validate": "newData.isString() && (newData.val() == 'play' || newData.val() == 'pause' || newData.val() == 'next' || newData.val() == 'previous' || newData.val() == 'volume_up' || newData.val() == 'volume_down')"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        },
        "media_status": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "isPlaying": {
            ".validate": "!newData.exists() || newData.isBoolean()"
          },
          "title": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "artist": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "album": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "appName": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "packageName": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "volume": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "maxVolume": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "hasPermission": {
            ".validate": "!newData.exists() || newData.isBoolean()"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        },
        "find_my_phone": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$requestId": {
            ".validate": "newData.hasChildren(['action', 'timestamp'])",
            "action": {
              ".validate": "newData.isString() && (newData.val() == 'ring' || newData.val() == 'stop')"
            },
            "timestamp": {
              ".validate": "newData.isNumber()"
            },
            "source": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "status": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        },
        "shared_links": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$linkId": {
            ".validate": "newData.hasChildren(['url', 'timestamp'])",
            "url": {
              ".validate": "newData.isString() && newData.val().length > 0"
            },
            "title": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "timestamp": {
              ".validate": "newData.isNumber()"
            },
            "source": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "status": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        },
        "hotspot_status": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)"
        },
        "hotspot_command": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "action": {
            ".validate": "newData.isString() && (newData.val() == 'enable' || newData.val() == 'disable')"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        },
        "dnd_status": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)"
        },
        "dnd_command": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "action": {
            ".validate": "newData.isString() && (newData.val() == 'enable' || newData.val() == 'disable')"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        },
        "scheduled_messages": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".indexOn": ["scheduledTime", "status"],
          "$messageId": {
            "address": {
              ".validate": "newData.isString()"
            },
            "body": {
              ".validate": "newData.isString()"
            },
            "scheduledTime": {
              ".validate": "newData.isNumber()"
            },
            "status": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        },
        "voicemails": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".indexOn": ["date"],
          "$voicemailId": {
            "phoneNumber": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "date": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "duration": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "isRead": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            }
          }
        },
        "photos": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)"
        },
        "mirrored_notifications": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$notificationId": {
            "appName": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "title": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "text": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "timestamp": {
              ".validate": "!newData.exists() || newData.isNumber()"
            }
          }
        },
        "recovery_info": {
          ".read": "auth != null && auth.uid == $uid",
          ".write": "auth != null && auth.uid == $uid",
          "code": {
            ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 20"
          },
          "createdAt": {
            ".validate": "newData.isNumber()"
          },
          "codeHash": {
            ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 64)"
          }
        },
        "sync_requests": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
          "$requestId": {
            ".validate": "newData.hasChildren(['days', 'status', 'requestedAt'])",
            "days": {
              ".validate": "newData.isNumber()"
            },
            "status": {
              ".validate": "newData.isString() && (newData.val() == 'pending' || newData.val() == 'in_progress' || newData.val() == 'completed' || newData.val() == 'failed')"
            },
            "requestedAt": {
              ".validate": "newData.isNumber()"
            },
            "requestedBy": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "startedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "completedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "failedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "syncedMessages": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "totalMessages": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "error": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          },
          ".indexOn": ["status", "requestedAt"]
        }
      }
    },
    "recovery_codes": {
      "$codeHash": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".validate": "newData.hasChildren(['userId', 'createdAt'])",
        "userId": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "createdAt": {
          ".validate": "newData.isNumber()"
        },
        "platform": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "lastUsedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        }
      }
    },
    "e2ee_keys": {
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || auth.token.pairedUid == $uid)",
        ".write": "auth != null && auth.uid == $uid",
        "publicKey": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "algorithm": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "version": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "platform": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "timestamp": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "$deviceId": {
          ".validate": "newData.hasChildren(['publicKeyX963'])",
          ".write": "auth != null && (auth.uid == $uid || (auth.token.pairedUid == $uid && auth.token.deviceId == $deviceId))",
          "publicKeyX963": {
            ".validate": "newData.isString() && newData.val().length > 0"
          },
          "format": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "keyVersion": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "platform": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        }
      }
    },
    "phone_to_uid": {
      "$phoneNumber": {
        ".read": "auth != null",
        ".write": "auth != null",
        ".validate": "newData.isString()"
      }
    },
    "pending_pairings": {
      ".read": false,
      ".write": false,
      "$token": {
        ".read": "auth != null && data.child('requesterUid').val() == auth.uid",
        ".write": false,
        ".validate": "newData.hasChildren(['expiresAt'])",
        "userId": {
          ".validate": "!newData.exists() || (newData.isString() && newData.val().length > 0)"
        },
        "createdAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "expiresAt": {
          ".validate": "newData.isNumber()"
        },
        "token": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "platform": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "macDeviceName": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "type": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "completedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "deviceName": {
          ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 50)"
        },
        "appVersion": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "status": {
          ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'pending' || newData.val() == 'approved' || newData.val() == 'rejected' || newData.val() == 'expired'))"
        },
        "approvedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "approvedBy": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "rejectedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "rejectedBy": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "pairedUid": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "deviceId": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "customToken": {
          ".validate": "!newData.exists() || newData.isString()"
        }
      }
    },
    "pairing_tokens": {
      ".read": false,
      ".write": false
    },
    "pairing_requests": {
      ".read": "auth != null",
      ".write": false,
      "$token": {
        ".write": false,
        ".validate": "newData.hasChildren(['expiresAt', 'deviceId', 'status'])",
        "deviceId": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
        },
        "deviceName": {
          ".validate": "!newData.exists() || (newData.isString() && newData.val().length <= 100)"
        },
        "deviceType": {
          ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'macos' || newData.val() == 'web'))"
        },
        "appVersion": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "status": {
          ".validate": "newData.isString() && (newData.val() == 'pending' || newData.val() == 'approved' || newData.val() == 'rejected' || newData.val() == 'expired')"
        },
        "createdAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "expiresAt": {
          ".validate": "newData.isNumber()"
        },
        "approvedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "approvedBy": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "rejectedAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "rejectedBy": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "pairedUid": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "customToken": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "version": {
          ".validate": "!newData.exists() || newData.isNumber()"
        }
      }
    },
    "phone_users": {
      ".read": false,
      ".write": false,
      "$phoneHash": {
        ".read": "auth != null",
        ".write": false,
        ".validate": "newData.hasChildren(['uid'])",
        "uid": {
          ".validate": "newData.isString() && newData.val().length > 0"
        },
        "createdAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "lastLogin": {
          ".validate": "!newData.exists() || newData.isNumber()"
        }
      }
    },
    "fcm_tokens": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid",
        ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 500"
      }
    },
    "fcm_notifications": {
      "$userId": {
        ".read": "auth != null",
        ".write": "auth != null",
        "$callId": {
          ".validate": "newData.hasChildren(['type', 'callId'])",
          "type": {
            ".validate": "newData.isString() && (newData.val() == 'incoming_call' || newData.val() == 'call_cancelled')"
          },
          "callId": {
            ".validate": "newData.isString()"
          },
          "callerName": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "callerPhone": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "isVideo": {
            ".validate": "!newData.exists() || newData.isString()"
          },
          "timestamp": {
            ".validate": "!newData.exists() || newData.isNumber()"
          }
        }
      }
    },
    "syncGroups": {
      "$syncGroupId": {
        ".read": "auth != null",
        ".write": "auth != null",
        "plan": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'free' || newData.val() == 'monthly' || newData.val() == 'yearly' || newData.val() == 'lifetime'))"
        },
        "deviceLimit": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "masterDevice": {
          ".validate": "!newData.exists() || newData.isString()"
        },
        "createdAt": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "planExpiresAt": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "wasPremium": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          ".validate": "!newData.exists() || newData.isBoolean()"
        },
        "firstPremiumDate": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "devices": {
          ".read": "auth != null",
          ".write": "auth != null",
          "$deviceId": {
            ".read": "auth != null",
            ".write": "auth != null",
            ".validate": "newData.hasChildren(['deviceType', 'joinedAt'])",
            "deviceType": {
              ".validate": "newData.isString() && (newData.val() == 'android' || newData.val() == 'macos' || newData.val() == 'web')"
            },
            "joinedAt": {
              ".validate": "newData.isNumber()"
            },
            "lastSyncedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "status": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'active' || newData.val() == 'inactive'))"
            }
          }
        },
        "history": {
          ".read": "auth != null",
          ".write": "auth != null && auth.token.admin === true",
          "$timestamp": {
            ".validate": "newData.hasChildren(['action'])",
            "action": {
              ".validate": "newData.isString()"
            },
            "deviceId": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "planChanged": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            },
            "newPlan": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "previousPlan": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        }
      }
    },
    "subscription_accounts": {
      "$deviceId": {
        ".read": "auth != null && auth.token.admin === true",
        ".write": "auth != null && auth.token.admin === true",
        "currentUid": {
          ".validate": "newData.isString()"
        },
        "currentPlan": {
          ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'monthly' || newData.val() == 'yearly' || newData.val() == 'lifetime' || newData.val() == 'free'))"
        },
        "wasPremium": {
          ".validate": "!newData.exists() || newData.isBoolean()"
        },
        "firstPremiumDate": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "totalPremiumDays": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "history": {
          "$timestamp": {
            ".validate": "newData.hasChildren(['uid'])",
            "uid": {
              ".validate": "newData.isString()"
            },
            "plan": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "createdAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "deletedAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "status": {
              ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'active' || newData.val() == 'deleted'))"
            }
          }
        }
      }
    },
    "subscription_records": {
      ".read": "auth != null && auth.token.admin === true",
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || auth.token.admin === true)",
        ".write": "auth != null && (auth.uid == $uid || auth.token.admin === true)",
        "active": {
          ".read": "auth != null && (auth.uid == $uid || auth.token.admin === true)",
          ".write": "auth != null && (auth.uid == $uid || auth.token.admin === true)",
          "plan": {
            ".validate": "!newData.exists() || (newData.isString() && (newData.val() == 'monthly' || newData.val() == 'yearly' || newData.val() == 'lifetime' || newData.val() == 'free'))"
          },
          "planExpiresAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "freeTrialExpiresAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "planAssignedAt": {
            ".validate": "!newData.exists() || newData.isNumber()"
          },
          "planAssignedBy": {
            ".validate": "!newData.exists() || newData.isString()"
          }
        },
        "wasPremium": {
          ".validate": "!newData.exists() || newData.isBoolean()"
        },
        "firstPremiumDate": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "totalPremiumDays": {
          ".validate": "!newData.exists() || newData.isNumber()"
        },
        "history": {
          "$timestamp": {
            ".validate": "newData.hasChildren(['timestamp', 'newPlan'])",
            "timestamp": {
              ".validate": "newData.isNumber()"
            },
            "previousPlan": {
              ".validate": "!newData.exists() || newData.isString()"
            },
            "newPlan": {
              ".validate": "newData.isString()"
            },
            "expiresAt": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "source": {
              ".validate": "!newData.exists() || newData.isString()"
            }
          }
        },
        "purchases": {
          "$purchaseId": {
            ".validate": "newData.hasChildren(['productId'])",
            "productId": {
              ".validate": "newData.isString()"
            },
            "purchaseDate": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "expirationDate": {
              ".validate": "!newData.exists() || newData.isNumber()"
            },
            "verified": {
              ".validate": "!newData.exists() || newData.isBoolean()"
            }
          }
        }
      }
    }
  }
}
